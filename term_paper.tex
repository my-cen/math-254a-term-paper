\documentclass{article}
\usepackage{amsmath, amssymb, mathtools} % essentials
\usepackage[backend=bibtex]{biblatex}
\addbibresource{term_paper.bib}
\nocite{*}
\usepackage{enumerate}
\usepackage{float}
\usepackage{amsthm}
\newtheorem{thm}{Theorem}
%\usepackage{tikz-cd}
%\usepackage{xcolor}
%\usepackage{url}
%\usepackage{graphicx}
%\graphicspath{{./}}
%\usepackage{enumitem}
%\usepackage{comment}

% convenience names
\newcommand{\nequiv}{\not\equiv}
\newcommand{\nsubset}{\not\subset}
\renewcommand{\emptyset}{\varnothing}
\newcommand{\xto}{\xrightarrow}
\newcommand{\injto}{\hookrightarrow}
\newcommand{\surjto}{\twoheadrightarrow}

\newcommand{\diff}{\mathop{}\!d} % as in $\int e^x \diff x$

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\DeclareMathOperator{\Cl}{Cl} % ideal class group
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Stab}{Stab}

% code from https://tex.stackexchange.com/a/2610/223981 that fixes a spacing issue with \left\right
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

\title{Fall 2024 Math 254A Term Paper}
\author{Mingyang Cen \\ Student ID: 3036462810 \\ Berkeley email address: \texttt{mcen@berkeley.edu}}

\begin{document}

\maketitle

\section{Introduction}
We will prove the following theorem:
\begin{thm}[The 15-Theorem]\label{15thm}
    A positive-definite integer-matrix quadratic form is universal (represents all positive integers) if and only if it represents the numbers 1, 2, 3, 5, 6, 7, 10, 14, and 15.
\end{thm}
In addition, each number in this list (called a \emph{critical number}) is necessary. More precisely,
\begin{thm}
    For each critical number $n$, there exists a positive-definite integer-matrix quadratic form representing all positive integers except $n$.
\end{thm}
A generalization is:
\begin{thm}\label{15thmgeneral}
    A positive-definite integer-matrix quadratic form representing all critical numbers besides $15$ must represent all positive integers besides $15$.
\end{thm}
By application of the Fifteen Theorem, we obtain the useful result that:
\begin{thm}\label{universal 4d}
    There are exactly $204$ positive-definite integer-matrix 4-dimensional quadratic forms representing all positive integers.
\end{thm}
A similar result to the Fifteen Theorem is the 290-theorem:
\begin{thm}[The 290-Theorem]
    A positive-definite integer-valued quadratic form represents all positive integers if and only if it represents 1, 2, 3, 5, 6, 7, 10, 13, 14, 15, 17, 19, 21, 22, 23, 26, 29, 30, 31, 34, 35, 37, 42, 58, 93, 110, 143, 203, and 290.
\end{thm}
Theorems 2 and 3 have similar generalizations for integer-valued quadratic forms: there are 6436 universal positive-definite integer-valued four-dimensional quadratic forms representing all positive integers.

In 1993, Conway and Schneeberger announced the first proof of the $15$-theorem. They did not publish it, because it required several complex arguments for many cases. In 2000, Bhargava \cite{fifteen} found a simple proof using escalations of quadratic forms, which we will present in this paper. In 2011, Bhargava and Hanke \cite{twoninety} used the same technique to successfully prove the 290-theorem.

\section{Definitions}
The word ``integer-matrix'' means the same as the notion of being classically integral. There is a well-known natural bijection between lattices with integer inner products and positive-definite integer-matrix quadratic forms. For convenience, a lattice or quadratic form refers to a positive-definite integer-matrix lattice or quadratic form. A quadratic form or its corresponding lattice is called universal if it represents all positive integers. If it is not universal, its truant is the smallest positive integer not represented. An escalation of a lattice $L$ is the lattice generated by $L$ and a vector of norm equal to the truant of $L$. An escalator lattice is one reached from a series of escalations from the zero lattice. A quadratic form has integer matrix if its matrix has only integer entries, and it is integer valued if when expressed as a polynomial, all coefficients are integers.

\section{Proof of $15$-theorem}
\subsection{Escalators of dimension $\le 3$}
The only quadratic form in $0$ variables is $0$, with truant $1$. Its unique escalation is $x^2$ (equivalently $\begin{bmatrix} 1 \end{bmatrix}$ as a matrix) with truant $2$, hence further escalations of dimension $2$ must have Gram matrix of the form
\[\begin{bmatrix} 1 & a \\ a & 2 \end{bmatrix}.\]
By Cauchy-Schwarz, $a$ is $0$ or $\pm 1$, creating two nonisomorphic escalations with Minkowski-reduced Gram matrices
\[\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}, \begin{bmatrix} 1 & 0 \\ 0 & 2 \end{bmatrix}.\]
Their truants are $3$ and $5$, respectively. By a similar argument, we can compute the $9$ three-dimensional escalations: they have Minkowski-reduced Gram matrices
\[\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 2 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 3 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 3 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 1 \\ 0 & 1 & 4 \end{bmatrix},\]
\[\begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 4 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 1 \\ 0 & 1 & 5 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 5 \end{bmatrix}.\]
By computation, they have truants $7, 14, 6, 7, 10, 7, 14, 7, 10$. Escalating again gives $207$ nonisomorphic four-dimensional escalator lattices; we will prove $201$ are universal and the other $6$ can be escalated again.

\subsection{Escalators of dimension $4$ and $5$}
For most of the four-dimensional escalators $L$, we can prove that they are universal easily. We find a $3$-dimensional sublattice $L'$ that is unique in its genus and use local arguments to prove that $L'$ represents all but a certain set of numbers, using Siegel's theorem.
For example, if $L'$ has Gram matrix $\begin{bsmallmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bsmallmatrix}$, then $L'$ represents numbers that are not of the form $4^a b$, where $a \ge 0$ and $b \equiv 7 \pmod 8$. Let $m$ be the single entry in the Gram matrix of the orthogonal complement of $L'$ in $L$. Suppose for the sake of contradiction that $L$ is not universal, and let $u$ be its truant. We can determine that $u$ is squarefree. By considering $u - xm$ where $x$ depends on $m$ modulo a certain number, we can find an upper bound for $u$. By manually checking $L$ represents all natural numbers below the upper bound, this shows $u$ cannot exist, so $L$ is universal.

As an example, let $L$ be an escalation of $L' = \begin{bsmallmatrix} 1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bsmallmatrix}$, where the orthogonal complement of $L'$ in $L$ has Gram matrix with one entry $m$. Since $L'$ is unique in its genus, we may calculate the numbers represented by it using calculations over the completions of $\mathbb{Q}$. Hence, it represents everything but positive integers of the form $4^a (8b + 7)$, where $a$ and $b$ are nonnegative integers.

Suppose for the sake of contradiction that $L$ is not universal, and let its truant be $u$. Since $L'$ cannot represent $u$, we can write $u$ in the form $4^a (8b + 7)$. Since $u$ is minimal, it is squarefree, so $a = 0$ and $u \equiv 7 \pmod 8$. We consider three cases depending on $m$ modulo $8$:
\begin{itemize}
    \item If $m$ is not congruent to $0$, $3$, or $7$ modulo $8$, then $u-m$ cannot be of the form $4^a (8b + 7)$.
    \item If $m \equiv 3, 7 \pmod 8$, then $u-4m$ cannot be of the form $4^a (8b + 7)$ either.
    \item If $m \equiv 0 \pmod 8$, then $L$ is called exceptional, and we have to use a different $L'$. More details are provided later in this paper.
\end{itemize}

Therefore, either $u < 4m$ or $u - m$ or $u - 4m$ (depending on $m \pmod 8$) is represented by $L'$. Because $L = L' \oplus [m]$, if $u - m$ or $u - 4m$ is represented by $L'$, $u$ is represented by $L$. This is false by assumption. Hence, $u$ must be less than $4m$. By computation, $m \le 28$, so $u < 112 = 4 \cdot 28$. Now that we have bounded $u$, we use computer checks to show that $L$ represents all positive integers up to $112$. This shows $u$ did not exist in the first place, so $L$ is universal.

By a similar argument, we find $201$ out of $207$ quaternary lattices are universal. There are only a couple of cases where different arguments have to be used. The three-dimensional escalator lattice
\[L = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 1 \\ 0 & 1 & 4 \end{bmatrix}\]
is the only one not unique in its genus, but it is ``nearly'' unique in its genus. Namely, it contains the lattice
\[\begin{bmatrix} 1 & 0 & 0 \\ 0 & 4 & 2 \\ 0 & 2 & 8 \end{bmatrix},\]
which is unique in its genus, and it contains the two lattices
\[\begin{bmatrix} 2 & -2 & 2 \\ -2 & 5 & 2 \\ 2 & 2 & 8 \end{bmatrix}, \begin{bmatrix} 3 & 0 & 0 \\ 0 & 5 & 4 \\ 0 & 4 & 5 \end{bmatrix}\]
that together form a genus. The former genus represents all numbers locally represented by $L$ that are not congruent to $2, 3 \pmod 4$, and the latter genus is the same except the condition is replaced with being congruent to $1 \pmod 3$. By the Chinese Remainder Theorem, this makes $L$ represent all numbers it locally represents that are not $7$ or $10 \pmod{12}$. This condition is nearly as good as being unique in a genus, so we may apply essentially the same argument as before.

Exceptional four-dimensional lattices $L$ can usually still have the argument above apply by changing $L'$. There are only five cases when there are no $L'$ that make $L$ non-exceptional. In those cases, we find a unique-in-its-genus three-dimensional sublattice $L'$ and apply mostly the same argument.

The other $6$ four-dimensional lattices are
\[\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 2 & 0 & 1 \\ 0 & 0 & 3 & 0 \\ 0 & 1 & 0 & 4 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 2 & 1 & 0 \\ 0 & 1 & 4 & 1 \\ 0 & 0 & 1 & 5 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 2 & 0 & 0 \\ 0 & 0 & 5 & 1 \\ 0 & 0 & 1 & 5 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 2 & 0 & 0 \\ 0 & 0 & 5 & 0 \\ 0 & 0 & 0 & 5 \end{bmatrix}, \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 2 & 0 & 1 \\ 0 & 0 & 5 & 2 \\ 0 & 1 & 2 & 8 \end{bmatrix},\]
and
\[\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 2 & 0 & 1 \\ 0 & 0 & 5 & 1 \\ 0 & 1 & 1 & 9 \end{bmatrix}.\]
These are not universal, with truants either $10$ or $15$. We may apply the same argument as above, but the final check that $L$ represents all positive integers up to some number fails with just one number. This shows that these $6$ lattices each miss that number and no others. That number is the lattice's truant, so the $5$-dimensional escalators of the lattice must be universal. This allows us to skip verifying every single one of the $1630$ five-dimensional escalators of these quadratic forms is universal.

\subsection{Proof of theorems \ref{15thm}, \ref{15thmgeneral}, and \ref{universal 4d}}
This shows all escalators of the zero lattice are at most $5$-dimensional, and that there are exactly $1850$ nonisomorphic escalator lattices of the zero lattice: $1$ of dimension $0$, $1$ of dimension $1$, $2$ of dimension $2$, $9$ of dimension $3$, $207$ of dimension $4$, and $1630$ of dimension $5$.

The non-universal escalators of $0$ we found have truants $1, 2, 3, 5, 6, 7, 10, 14$ and $15$. This proves the $15$-theorem, and that each of these numbers is actually necessary. Since each of the four escalators of the zero lattice that has truant $15$ is four-dimensional and hence must represent all other positive integers, the strengthening of the $15$-theorem is proved. Furthermore, $15$ is special: there exist quadratic forms that miss infinitely many integers starting from any of the critical integers beside $15$.

The $15$-theorem has several corollaries. This also proves that a universal lattice $L$ must contain a universal sublattice of dimension $5$ or less, because $L$ must contain a chain of escalations of the zero lattice.

In addition, this provides a shortcut to classifying all universal $4$-variable positive-definite integer-matrix quadratic forms. We find a bound on the discriminant of such a quadratic form and systematically apply the $15$-theorem to find there are exactly $204$ of them. This was used by Bhargava to determine that Willerding's classification of universal quaternary forms had errors.

\section{290-theorem}
\subsection{Introduction and 3-dimensional escalators}
The $290$-theorem \cite{twoninety} states that an integer-\emph{valued} positive-definite quadratic form is universal if and only if it represents the $29$ critical numbers
\[\begin{split}
    &1,2,3,5,6,7,10,13,14,15,17,19,21,22,23,26,29,30, \\
    &31,34,35,37,42,58,93,110,145,203,290,
\end{split}\] %make sure the numbers are right
and it has a similar strengthening as the $15$-theorem.
The structure of the proof is mostly the same.
In this section, a lattice will refer to an integer-\emph{valued} positive-definite lattice.

Through calculation, the $34$ three-dimensional escalators of the zero lattice are determined and calculated to have critical truants.
Their escalations are called \emph{basic} $4$-dimensional escalators. Although many of the basic $4$-dimensional escalators can be escalated to obtain more $4$-dimensional lattices, it suffices to look at only the basic ones.

\subsection{Techniques for dealing with all basic $4$-dimensional escalators}
Many basic four-dimensional escalator lattices $L_4$ can be proven to be universal by the same algebraic argument as in the $15$-theorem:
find a three-dimensional sublattice $L_3$ unique in its genus that represents a large set of integers, ensure $L_4$ is not exceptional over $L_3$, and use this to show $L_4$ is universal.

However, more than $2300$ of the $6560$ basic four-dimensional escalator lattices cannot be proven to be universal using this method.
Instead, we use modular forms. For a quadratic form $Q$ in $n$ variables where $r_Q(m)$ denotes the number of ways $m$ can be represented by $Q$, we may create its Fourier series generating function
\[\Theta_Q(z) = \sum_{m = 0}^{\infty} r_Q(m) e^{2\pi i m z},\]
which turns out to be a weight-$n/2$ modular form. Through a detailed study of the properties of $\Theta_Q$, we find that a quadratic form represents all numbers it locally represents with exceptions only up to a certain number $N$, which can be shown to be relatively small.

In the end, this separates all basic four-dimensional escalator lattices into three categories:
\begin{itemize}
    \item Type I: universal
    \item Type II: not universal but misses at most three values, that are each critical
    \item Type III: represents positive integers not of the form $4^a(16k+14)$
\end{itemize}
We would like to consider the further escalations of these basic quaternaries and their truants.
For types I and II, this is easy.
Namely, Type I lattices cannot be escalated further at all, and Type II lattices can be escalated at most three times, with each further escalator having truant being one of the critical numbers.
The main problem is about the escalations of Type III lattices, since they could miss infinitely many numbers. Without further argument, they could conceivably be escalated infinitely many times, yielding quadratic forms of arbitrarily large truant.

The crucial technique used to solve this dilemma is the ``10-14 switch''.
It is impractical to consider every four- or five-dimensional escalation of a basic Type III escalator lattices individually.
The 10-14 switch provides a uniform way to treat these.
Each of the five Type III basic quaternaries, namely,
\[\begin{bmatrix} \\ \\ \text{please insert matrices }^.\frown\text{}^. \\{} \end{bmatrix},\]
are of truant $14$, and they are escalations of the $3$-dimensional lattice
\[L = \begin{bmatrix} 1 & 0 & 1/2 \\ 0 & 2 & 1 \\ 1/2 & 1 & 5 \end{bmatrix}\]
of truant $10$.
That is, if $L'$ denotes one of the five Type III escalator lattices and $M$ is an escalation of $L'$, then $L'$ is obtained by joining a vector of norm $10$ to $L$, and $L''$ is obtained by joining a vector of norm $14$ of $L'$.

However, it is possible to switch the order of these two operations.
Let an \emph{auxiliary quaternary} be a lattice generated by $L$ and a vector of norm $14$.
Each auxiliary quaternary has truant $10$, so $M$ can be obtained as an escalation of an auxiliary quaternary.
Hence, it suffices to scrutinize the escalations of auxiliary quaternaries, in place of the difficult Type III basic quaterneries.

Impressively, $226$ of the $330$ auxiliary quaternaries are isometric to Type I or Type II basic quaternaries, so they can be escalated at most three times, and their escalators' truants are automatically critical numbers. The other $104$ are either type I, type II, or a new type called Type IV:
\begin{itemize}
    \item Type IV: represents all integers that are not of the form $10n^2$ or $13n^2$.
\end{itemize}
By easy calculation, each of these can be escalated at most three times, and their escalators' truants are critical numbers.

\subsection{Final proof of the 290-theorem and other results for integer-valued quadratic forms}
This proves similar results as before. Through inspection of each lattice, the zero lattice cannot be escalated more than $7$ times.

\begin{proof}[Proof of the 290-theorem]
    By considering chains of escalations within a lattice, all information about lattice universality is contained within the study of escalator lattices. Since all escalator lattices have truants that are critical numbers, the $290$-theorem is proved.
\end{proof}

\begin{proof}[Proof of theorem \ref{15thmgeneral} for integer-valued lattices]
    We notice that all escalators of truant $290$ must be a sequence of escalations of
    \[\begin{bmatrix}
    1 & 0 & -1/2 & 0 \\
    0 & 2 & -1/2 & 0 \\
    -1/2 & -1/2 & 4 & 0 \\
    0 & 0 & 0 & 29
    \end{bmatrix},\]
    which fails to represent precisely $145, 203, 290$. Since each of these numbers is less than $290$, this proves the generalization.
\end{proof}

\begin{proof}[Proof of theorem \ref{universal 4d} for integer-valued lattices]
    We use the same argument as for integer-matrix quadratic forms: finding a bound on the discriminant of such a quadratic form, then systematically applying the 15-theorem through each case.
\end{proof}

\section{blahblah}

The $33$- and $451$-theorem prove similar statements for odd universal integer-valued and integer-matrix quadratic forms, respectively. There have been various generalizations to quadratic forms representing prime numbers (insert reference here), numbers coprime to a certain prime (insert reference here), and more.

The source code for this term paper is at \url{https://github.com/my-cen/math-254a-term-paper/blob/main/math_254a_term_paper.ipynb}.

\printbibliography

\end{document}
